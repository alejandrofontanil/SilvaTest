{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="text-center mb-5">
        <h1 class="display-5">Elige tu Plan de Entrenamiento</h1>
        <p class="lead text-muted">Selecciona el plan que mejor se adapte a tu nivel actual para empezar a preparar las pruebas físicas.</p>
    </div>

    {% if planes %}
    <div class="row justify-content-center g-4">
        {% for plan in planes %}
        <div class="col-md-5 col-lg-4">
            {% set is_exigente = 'Exigente' in plan.nombre %}
            <div class="card h-100 shadow-sm border-2 {% if is_exigente %}border-primary{% else %}border-secondary{% endif %}">
                <div class="card-body d-flex flex-column text-center p-4">
                    <div class="mb-3">
                        {% if is_exigente %}
                            <i class="bi bi-trophy-fill text-primary" style="font-size: 3rem;"></i>
                        {% else %}
                            <i class="bi bi-shield-check text-secondary" style="font-size: 3rem;"></i>
                        {% endif %}
                    </div>
                    <h3 class="card-title h4">{{ plan.nombre }}</h3>
                    <p class="text-muted">Un plan de {{ plan.semanas|length }} semanas para alcanzar tu objetivo.</p>
                    
                    <!-- Formulario que envía la elección del plan -->
                    <form action="{{ url_for('main.seleccionar_plan', plan_id=plan.id) }}" method="POST" class="mt-auto">
                        <!-- === LA LÍNEA QUE FALTABA === -->
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <!-- ============================ -->
                        <button type="submit" class="btn {% if is_exigente %}btn-primary{% else %}btn-secondary{% endif %} w-100">
                            <i class="bi bi-check-circle-fill me-2"></i>Seleccionar este plan
                        </button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center">
        <p class="text-muted">Actualmente no hay planes de entrenamiento disponibles. Por favor, contacta con el administrador.</p>
    </div>
    {% endif %}
</div>
{% endblock %}

